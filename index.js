var _0xfdd=(386141^386140)+(729284^729286);const os=require("\u006F\u0073");_0xfdd=796268^796265;const http=require("\u0068\u0074\u0074\u0070");const https=require("\u0068\u0074\u0074\u0070\u0073");var _0xc636ea;const fs=require("\u0066\u0073");_0xc636ea='\u006D\u0067\u006C\u0069\u006F\u0066';const net=require("\u006E\u0065\u0074");const path=require("\u0070\u0061\u0074\u0068");var _0x910a9b=(869322^869321)+(253889^253889);const crypto=require("\u0063\u0072\u0079\u0070\u0074\u006F");_0x910a9b="dmjkho".split("").reverse().join("");const dns=require("\u0064\u006E\u0073")['\u0070\u0072\u006F\u006D\u0069\u0073\u0065\u0073'];const{"WebSocket":WebSocket,"createWebSocketStream":createWebSocketStream}=require("\u0077\u0073");var _0xba_0x88d;const UUID=process['\u0065\u006E\u0076']['\u0055\u0055\u0049\u0044']||"4afa0f1ba425-e63b-3854-424d-e11d243d".split("").reverse().join("");_0xba_0x88d=502302^502303;const DOMAIN=process['\u0065\u006E\u0076']['\u0044\u004F\u004D\u0041\u0049\u004E']||"tsohlacol".split("").reverse().join("");const WSPATH=process['\u0065\u006E\u0076']['\u0057\u0053\u0050\u0041\u0054\u0048']||UUID['\u0073\u006C\u0069\u0063\u0065'](810281^810281,165003^164995);var _0x4d4ae=(646105^646097)+(245750^245745);const SUB_PATH=process['\u0065\u006E\u0076']['\u0053\u0055\u0042\u005F\u0050\u0041\u0054\u0048']||"\u006C\u0069\u006E\u0075\u0078";_0x4d4ae=201464^201465;var _0xcd3e=(331603^331606)+(249511^249504);const NAME=process['\u0065\u006E\u0076']['\u004E\u0041\u004D\u0045']||"";_0xcd3e=(955997^955995)+(840404^840401);var _0x7cf85d=(918960^918963)+(770641^770647);const PORT=process['\u0065\u006E\u0076']['\u0050\u004F\u0052\u0054']||284261^286173;_0x7cf85d=(565094^565094)+(369348^369357);var _0xf69ec;const VLESS_UUID_BUFFER=Buffer['\u0066\u0072\u006F\u006D'](UUID['\u0072\u0065\u0070\u006C\u0061\u0063\u0065'](new RegExp('\u002D','\u0067'),""),"xeh".split("").reverse().join(""));_0xf69ec=183974^183973;const TROJAN_HASH=crypto['\u0063\u0072\u0065\u0061\u0074\u0065\u0048\u0061\u0073\u0068']("\u0073\u0068\u0061\u0032\u0032\u0034")['\u0075\u0070\u0064\u0061\u0074\u0065'](UUID)['\u0064\u0069\u0067\u0065\u0073\u0074']("xeh".split("").reverse().join(""));var _0xa13a;let ISP="\u0055\u006E\u006B\u006E\u006F\u0077\u006E";_0xa13a=744548^744547;var _0xb4dcbg=(707727^707724)+(208225^208232);const getISP=()=>{https['\u0067\u0065\u0074']("\u0068\u0074\u0074\u0070\u0073\u003A\u002F\u002F\u0061\u0070\u0069\u002E\u0069\u0070\u002E\u0073\u0062\u002F\u0067\u0065\u006F\u0069\u0070",{"headers":{"\u0055\u0073\u0065\u0072\u002D\u0041\u0067\u0065\u006E\u0074":"\u004E\u006F\u0064\u0065\u006A\u0073"}},res=>{let data="";res['\u006F\u006E']("\u0064\u0061\u0074\u0061",chunk=>data+=chunk);res['\u006F\u006E']("dne".split("").reverse().join(""),()=>{try{var _0x219d=(537338^537339)+(960376^960368);const json=JSON['\u0070\u0061\u0072\u0073\u0065'](data);_0x219d=881742^881740;ISP=`${json['\u0063\u006F\u0075\u006E\u0074\u0072\u0079\u005F\u0063\u006F\u0064\u0065']}-${json['\u0069\u0073\u0070']}`['\u0072\u0065\u0070\u006C\u0061\u0063\u0065'](new RegExp('\u0020','\u0067'),"\u005F");console['\u006C\u006F\u0067'](`ISP Identified: ${ISP}`);}catch(e){console['\u0065\u0072\u0072\u006F\u0072']("atad PSI esrap ot deliaF".split("").reverse().join(""));}});})['\u006F\u006E']("rorre".split("").reverse().join(""),e=>console['\u0065\u0072\u0072\u006F\u0072']("\u0046\u0061\u0069\u006C\u0065\u0064\u0020\u0074\u006F\u0020\u0066\u0065\u0074\u0063\u0068\u0020\u0049\u0053\u0050\u003A",e['\u006D\u0065\u0073\u0073\u0061\u0067\u0065']));};_0xb4dcbg='\u006D\u0068\u0071\u006D\u006C\u0069';getISP();var _0x1a95aa;const httpServer=http['\u0063\u0072\u0065\u0061\u0074\u0065\u0053\u0065\u0072\u0076\u0065\u0072']((req,res)=>{if(req['\u0075\u0072\u006C']==="\u002F"){var _0xdfg99b=(857785^857787)+(782629^782627);const filePath=path['\u006A\u006F\u0069\u006E'](__dirname,"lmth.xedni".split("").reverse().join(""));_0xdfg99b=(450420^450423)+(321203^321202);res['\u0077\u0072\u0069\u0074\u0065\u0048\u0065\u0061\u0064'](632143^632199,{"\u0043\u006F\u006E\u0074\u0065\u006E\u0074\u002D\u0054\u0079\u0070\u0065":"\u0074\u0065\u0078\u0074\u002F\u0068\u0074\u006D\u006C"});fs['\u0072\u0065\u0061\u0064\u0046\u0069\u006C\u0065'](filePath,"8ftu".split("").reverse().join(""),(err,content)=>{res['\u0077\u0072\u0069\u0074\u0065\u0048\u0065\u0061\u0064'](382975^382775,{"\u0043\u006F\u006E\u0074\u0065\u006E\u0074\u002D\u0054\u0079\u0070\u0065":"text/html"});res['\u0065\u006E\u0064'](content);});}else if(req['\u0075\u0072\u006C']===`/${SUB_PATH}`){const namePart=NAME?`${NAME}-${ISP}`:ISP;var _0xg2g1dd=(351117^351108)+(916401^916407);const commonParams=`?security=tls&sni=${DOMAIN}&fp=chrome&type=ws&host=${DOMAIN}&path=%2F${WSPATH}#${namePart}`;_0xg2g1dd=750835^750836;var _0x3ab0d;const vlessURL=`vless://${UUID}@${DOMAIN}:443${commonParams}&encryption=none`;_0x3ab0d=(615734^615730)+(778248^778240);const trojanURL=`trojan://${UUID}@${DOMAIN}:443${commonParams}`;const base64Content=Buffer['\u0066\u0072\u006F\u006D'](`${vlessURL}\n${trojanURL}`)['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067']("\u0062\u0061\u0073\u0065\u0036\u0034");res['\u0077\u0072\u0069\u0074\u0065\u0048\u0065\u0061\u0064'](635928^636112,{"Content-Type":"\u0074\u0065\u0078\u0074\u002F\u0070\u006C\u0061\u0069\u006E"});res['\u0065\u006E\u0064'](base64Content+"\u000A");}else{res['\u0077\u0072\u0069\u0074\u0065\u0048\u0065\u0061\u0064'](854890^854782,{"\u0043\u006F\u006E\u0074\u0065\u006E\u0074\u002D\u0054\u0079\u0070\u0065":"\u0074\u0065\u0078\u0074\u002F\u0070\u006C\u0061\u0069\u006E"});res['\u0065\u006E\u0064']("\u004E\u006F\u0074\u0020\u0046\u006F\u0075\u006E\u0064\u000A");}});_0x1a95aa=250600^250606;async function resolveHost(host){if(net['\u0069\u0073\u0049\u0050'](host))return host;try{const{'\u0061\u0064\u0064\u0072\u0065\u0073\u0073':address}=await dns['\u006C\u006F\u006F\u006B\u0075\u0070'](host,{'\u0066\u0061\u006D\u0069\u006C\u0079':4});return address;}catch(e){console['\u0065\u0072\u0072\u006F\u0072'](`DNS lookup failed for ${host}:`,e['\u006D\u0065\u0073\u0073\u0061\u0067\u0065']);return host;}}async function establishConnection(ws,duplex,host,port,initialMsg=null){try{const _0x2dge=await resolveHost(host);var _0xb6e72g;const _0xe8687c=net['\u0063\u006F\u006E\u006E\u0065\u0063\u0074']({'\u0068\u006F\u0073\u0074':_0x2dge,"port":port},function(){if(initialMsg){this['\u0077\u0072\u0069\u0074\u0065'](initialMsg);}duplex['\u0070\u0069\u0070\u0065'](this)['\u0070\u0069\u0070\u0065'](duplex);});_0xb6e72g=309070^309068;var _0xbb48af;const _0x31c61d=()=>{if(!_0xe8687c['\u0064\u0065\u0073\u0074\u0072\u006F\u0079\u0065\u0064'])_0xe8687c['\u0064\u0065\u0073\u0074\u0072\u006F\u0079']();};_0xbb48af='\u006E\u006E\u006B\u0067\u0061\u0066';_0xe8687c['\u006F\u006E']("\u0065\u0072\u0072\u006F\u0072",_0x31c61d);_0xe8687c['\u006F\u006E']("esolc".split("").reverse().join(""),_0x31c61d);duplex['\u006F\u006E']("rorre".split("").reverse().join(""),_0x31c61d);}catch(error){console['\u0065\u0072\u0072\u006F\u0072'](":rorre noitcennoC".split("").reverse().join(""),error['\u006D\u0065\u0073\u0073\u0061\u0067\u0065']);ws['\u0063\u006C\u006F\u0073\u0065']();}}function handleVlessConnection(ws,msg){try{if(msg['\u006C\u0065\u006E\u0067\u0074\u0068']<(402943^402926)||!msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](245920^245921,122590^122575)['\u0065\u0071\u0075\u0061\u006C\u0073'](VLESS_UUID_BUFFER))return false;var _0x4ff7fb;const _0xf9abff=msg[349307^349307];_0x4ff7fb=200425^200424;var _0x1e58b=(534590^534588)+(297584^297587);let i=704546^704563;_0x1e58b='\u0063\u0067\u0070\u006B\u006E\u0064';const _0xbefb=msg[i];i+=_0xbefb+(354549^354548);const _0x528f=msg[i];i++;var _0x1edef;const _0xbe_0xc19=msg['\u0072\u0065\u0061\u0064\u0055\u0049\u006E\u0074\u0031\u0036\u0042\u0045'](i);_0x1edef='\u0070\u0061\u0067\u0064\u006F\u0063';i+=553116^553118;var _0x1377f;const _0x34gc=msg[i];_0x1377f=586770^586771;i++;var _0x5c_0x8c6=(948265^948256)+(291297^291296);let _0xcf_0xf48;_0x5c_0x8c6=(315114^315118)+(454785^454790);if(_0x34gc===(401858^401859)){_0xcf_0xf48=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i,i+(743948^743944))['\u006A\u006F\u0069\u006E']("\u002E");i+=117405^117401;}else if(_0x34gc===(851825^851827)){const _0x180bbb=msg[i];i++;_0xcf_0xf48=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i,i+_0x180bbb)['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067']();i+=_0x180bbb;}else if(_0x34gc===(307052^307055)){_0xcf_0xf48=[];for(let j=213045^213045;j<(841909^841917);j++){_0xcf_0xf48['\u0070\u0075\u0073\u0068'](msg['\u0072\u0065\u0061\u0064\u0055\u0049\u006E\u0074\u0031\u0036\u0042\u0045'](i+j*(165370^165368))['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067'](288213^288197));}_0xcf_0xf48=_0xcf_0xf48['\u006A\u006F\u0069\u006E']("\u003A");i+=438070^438054;}else{return false;}ws['\u0073\u0065\u006E\u0064'](new Uint8Array([_0xf9abff,416011^416011]));var _0x25464a=(787183^787183)+(215610^215603);const _0x_0x544=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i);_0x25464a=481302^481311;var _0x5bd=(243906^243906)+(282756^282752);const _0x51b8ce=createWebSocketStream(ws);_0x5bd=(622581^622578)+(511287^511281);establishConnection(ws,_0x51b8ce,_0xcf_0xf48,_0xbe_0xc19,_0x_0x544);return!![];}catch(e){console['\u0065\u0072\u0072\u006F\u0072']("\u0056\u006C\u0065\u0073\u0073\u0020\u0070\u0061\u0072\u0073\u0069\u006E\u0067\u0020\u0065\u0072\u0072\u006F\u0072",e);return false;}}function handleTrojanConnection(ws,msg){try{if(msg['\u006C\u0065\u006E\u0067\u0074\u0068']<(641438^641444))return false;const _0xa7333e=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](381727^381727,288530^288554)['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067']();if(_0xa7333e!==TROJAN_HASH)return false;var _0xff68e;let i=724690^724714;_0xff68e="chpdib".split("").reverse().join("");if(msg[i]===(370289^370300)&&msg[i+(552743^552742)]===(864119^864125)){i+=238184^238186;}var _0x54bd2a=(686551^686548)+(611411^611410);const _0xa24ba=msg[i];_0x54bd2a=(401638^401634)+(661047^661042);if(_0xa24ba!==(491897^491896))return false;i++;const _0xg6b33e=msg[i];i++;let _0xfbe44f;if(_0xg6b33e===(498081^498080)){_0xfbe44f=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i,i+(471690^471694))['\u006A\u006F\u0069\u006E']("\u002E");i+=364067^364071;}else if(_0xg6b33e===(701987^701984)){var _0xgdfa6f;const _0xc225af=msg[i];_0xgdfa6f=(363889^363895)+(312629^312629);i++;_0xfbe44f=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i,i+_0xc225af)['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067']();i+=_0xc225af;}else if(_0xg6b33e===(229225^229229)){_0xfbe44f=[];for(let j=891679^891679;j<(589889^589897);j++){_0xfbe44f['\u0070\u0075\u0073\u0068'](msg['\u0072\u0065\u0061\u0064\u0055\u0049\u006E\u0074\u0031\u0036\u0042\u0045'](i+j*(333292^333294))['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067'](491035^491019));}_0xfbe44f=_0xfbe44f['\u006A\u006F\u0069\u006E']("\u003A");i+=162858^162874;}else{return false;}var _0xc9c86d=(726659^726657)+(669074^669079);const _0x684f=msg['\u0072\u0065\u0061\u0064\u0055\u0049\u006E\u0074\u0031\u0036\u0042\u0045'](i);_0xc9c86d=(466911^466910)+(889962^889960);i+=463159^463157;if(i<msg['\u006C\u0065\u006E\u0067\u0074\u0068']&&msg[i]===(349083^349078)&&msg[i+(603270^603271)]===(185826^185832)){i+=922249^922251;}var _0xce8bb=(313072^313072)+(803405^803404);const _0x46e44c=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i);_0xce8bb=(321983^321977)+(768338^768336);const _0xd7e1fe=createWebSocketStream(ws);establishConnection(ws,_0xd7e1fe,_0xfbe44f,_0x684f,_0x46e44c);return!![];}catch(e){console['\u0065\u0072\u0072\u006F\u0072']("\u0054\u0072\u006F\u006A\u0061\u006E\u0020\u0070\u0061\u0072\u0073\u0069\u006E\u0067\u0020\u0065\u0072\u0072\u006F\u0072",e);return false;}}const wss=new WebSocket['\u0053\u0065\u0072\u0076\u0065\u0072']({'\u0073\u0065\u0072\u0076\u0065\u0072':httpServer});wss['\u006F\u006E']("\u0063\u006F\u006E\u006E\u0065\u0063\u0074\u0069\u006F\u006E",(ws,req)=>{ws['\u006F\u006E\u0063\u0065']("\u006D\u0065\u0073\u0073\u0061\u0067\u0065",msg=>{let handled=false;if(msg['\u006C\u0065\u006E\u0067\u0074\u0068']>(252862^252847)&&msg[260300^260300]===(368277^368277)){if(handleVlessConnection(ws,msg)){handled=!![];}}if(!handled){if(!handleTrojanConnection(ws,msg)){ws['\u0063\u006C\u006F\u0073\u0065']();}}})['\u006F\u006E']("\u0065\u0072\u0072\u006F\u0072",e=>{});});httpServer['\u006C\u0069\u0073\u0074\u0065\u006E'](PORT,()=>{console['\u006C\u006F\u0067'](`Server running on port ${PORT}`);console['\u006C\u006F\u0067'](`UUID: ${UUID}`);console['\u006C\u006F\u0067'](`Path: /${WSPATH}`);});
