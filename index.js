var _0x57aaa;const os=require("\u006F\u0073");_0x57aaa=(191398^191407)+(435355^435354);var _0x40eebb;const http=require("\u0068\u0074\u0074\u0070");_0x40eebb=699226^699226;const https=require("\u0068\u0074\u0074\u0070\u0073");const fs=require("\u0066\u0073");const net=require("\u006E\u0065\u0074");const path=require("\u0070\u0061\u0074\u0068");var _0x75e4b;const crypto=require("\u0063\u0072\u0079\u0070\u0074\u006F");_0x75e4b=(218715^218706)+(654612^654620);const dns=require("\u0064\u006E\u0073")['\u0070\u0072\u006F\u006D\u0069\u0073\u0065\u0073'];const{'\u0057\u0065\u0062\u0053\u006F\u0063\u006B\u0065\u0074':WebSocket,"createWebSocketStream":createWebSocketStream}=require("\u0077\u0073");var _0xb8749e=(989363^989362)+(835110^835106);const UUID=process['\u0065\u006E\u0076']['\u0055\u0055\u0049\u0044']||"\u0064\u0033\u0034\u0032\u0064\u0031\u0031\u0065\u002D\u0064\u0034\u0032\u0034\u002D\u0034\u0035\u0038\u0033\u002D\u0062\u0033\u0036\u0065\u002D\u0035\u0032\u0034\u0061\u0062\u0031\u0066\u0030\u0061\u0066\u0061\u0034";_0xb8749e=(248027^248019)+(183534^183534);var _0x4e_0xe4c=(816554^816558)+(418188^418181);const DOMAIN=process['\u0065\u006E\u0076']['\u0044\u004F\u004D\u0041\u0049\u004E']||"\u006C\u006F\u0063\u0061\u006C\u0068\u006F\u0073\u0074";_0x4e_0xe4c=(489861^489858)+(132733^132735);const WSPATH=process['\u0065\u006E\u0076']['\u0057\u0053\u0050\u0041\u0054\u0048']||UUID['\u0073\u006C\u0069\u0063\u0065'](980837^980837,835787^835779);var _0x96acf;const SUB_PATH=process['\u0065\u006E\u0076']['\u0053\u0055\u0042\u005F\u0050\u0041\u0054\u0048']||"xunil".split("").reverse().join("");_0x96acf='\u006C\u006C\u0070\u0064\u006A\u0061';const NAME=process['\u0065\u006E\u0076']['\u004E\u0041\u004D\u0045']||"";const PORT=process['\u0065\u006E\u0076']['\u0050\u004F\u0052\u0054']||767721^769361;const VLESS_UUID_BUFFER=Buffer['\u0066\u0072\u006F\u006D'](UUID['\u0072\u0065\u0070\u006C\u0061\u0063\u0065'](new RegExp('\u002D','\u0067'),""),"\u0068\u0065\u0078");const TROJAN_HASH=crypto['\u0063\u0072\u0065\u0061\u0074\u0065\u0048\u0061\u0073\u0068']("\u0073\u0068\u0061\u0032\u0032\u0034")['\u0075\u0070\u0064\u0061\u0074\u0065'](UUID)['\u0064\u0069\u0067\u0065\u0073\u0074']("\u0068\u0065\u0078");var _0xa8f51f;let ISP="\u0055\u006E\u006B\u006E\u006F\u0077\u006E";_0xa8f51f=(151517^151514)+(483569^483568);var _0x37c3fa;const getISP=()=>{https['\u0067\u0065\u0074']("\u0068\u0074\u0074\u0070\u0073\u003A\u002F\u002F\u0061\u0070\u0069\u002E\u0069\u0070\u002E\u0073\u0062\u002F\u0067\u0065\u006F\u0069\u0070",{'\u0068\u0065\u0061\u0064\u0065\u0072\u0073':{"\u0055\u0073\u0065\u0072\u002D\u0041\u0067\u0065\u006E\u0074":'Nodejs'}},res=>{var _0xa9b8c=(881719^881718)+(185395^185395);let data="";_0xa9b8c='\u006D\u006B\u0069\u0062\u0061\u0066';res['\u006F\u006E']("atad".split("").reverse().join(""),chunk=>data+=chunk);res['\u006F\u006E']("\u0065\u006E\u0064",()=>{try{const json=JSON['\u0070\u0061\u0072\u0073\u0065'](data);ISP=`${json['\u0063\u006F\u0075\u006E\u0074\u0072\u0079\u005F\u0063\u006F\u0064\u0065']}-${json['\u0069\u0073\u0070']}`['\u0072\u0065\u0070\u006C\u0061\u0063\u0065'](new RegExp('\u0020','\u0067'),"\u005F");console['\u006C\u006F\u0067'](`ISP Identified: ${ISP}`);}catch(e){console['\u0065\u0072\u0072\u006F\u0072']("atad PSI esrap ot deliaF".split("").reverse().join(""));}});})['\u006F\u006E']("rorre".split("").reverse().join(""),e=>console['\u0065\u0072\u0072\u006F\u0072']("\u0046\u0061\u0069\u006C\u0065\u0064\u0020\u0074\u006F\u0020\u0066\u0065\u0074\u0063\u0068\u0020\u0049\u0053\u0050\u003A",e['\u006D\u0065\u0073\u0073\u0061\u0067\u0065']));};_0x37c3fa=(810380^810382)+(926332^926325);getISP();var _0xda_0xcge=(896578^896586)+(518636^518634);const httpServer=http['\u0063\u0072\u0065\u0061\u0074\u0065\u0053\u0065\u0072\u0076\u0065\u0072']((req,res)=>{if(req['\u0075\u0072\u006C']==="\u002F"){const filePath=path['\u006A\u006F\u0069\u006E'](__dirname,"\u0069\u006E\u0064\u0065\u0078\u002E\u0068\u0074\u006D\u006C");res['\u0077\u0072\u0069\u0074\u0065\u0048\u0065\u0061\u0064'](350563^350635,{"\u0043\u006F\u006E\u0074\u0065\u006E\u0074\u002D\u0054\u0079\u0070\u0065":"text/html"});fs['\u0063\u0072\u0065\u0061\u0074\u0065\u0052\u0065\u0061\u0064\u0053\u0074\u0072\u0065\u0061\u006D'](filePath)['\u0070\u0069\u0070\u0065'](res)['\u006F\u006E']("rorre".split("").reverse().join(""),()=>{res['\u0065\u006E\u0064']("\u0048\u0065\u006C\u006C\u006F\u0020\u0057\u006F\u0072\u006C\u0064\u0021");});}else if(req['\u0075\u0072\u006C']===`/${SUB_PATH}`){var _0x4e3dc;const namePart=NAME?`${NAME}-${ISP}`:ISP;_0x4e3dc=(380983^380979)+(377071^377069);const commonParams=`?security=tls&sni=${DOMAIN}&fp=chrome&type=ws&host=${DOMAIN}&path=%2F${WSPATH}#${namePart}`;const vlessURL=`vless://${UUID}@${DOMAIN}:443${commonParams}&encryption=none`;const trojanURL=`trojan://${UUID}@${DOMAIN}:443${commonParams}`;var _0xe1d6aa=(748758^748757)+(449692^449695);const base64Content=Buffer['\u0066\u0072\u006F\u006D'](`${vlessURL}\n${trojanURL}`)['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067']("\u0062\u0061\u0073\u0065\u0036\u0034");_0xe1d6aa=(268494^268487)+(426254^426252);res['\u0077\u0072\u0069\u0074\u0065\u0048\u0065\u0061\u0064'](453017^452945,{"\u0043\u006F\u006E\u0074\u0065\u006E\u0074\u002D\u0054\u0079\u0070\u0065":"text/plain"});res['\u0065\u006E\u0064'](base64Content+"\u000A");}else{res['\u0077\u0072\u0069\u0074\u0065\u0048\u0065\u0061\u0064'](535805^535913,{"Content-Type":"text/plain"});res['\u0065\u006E\u0064']("\u004E\u006F\u0074\u0020\u0046\u006F\u0075\u006E\u0064\u000A");}});_0xda_0xcge=(154857^154863)+(828634^828634);async function resolveHost(host){if(net['\u0069\u0073\u0049\u0050'](host))return host;try{const{"address":address}=await dns['\u006C\u006F\u006F\u006B\u0075\u0070'](host,{'\u0066\u0061\u006D\u0069\u006C\u0079':4});return address;}catch(e){console['\u0065\u0072\u0072\u006F\u0072'](`DNS lookup failed for ${host}:`,e['\u006D\u0065\u0073\u0073\u0061\u0067\u0065']);return host;}}async function establishConnection(ws,duplex,host,port,initialMsg=null){try{var _0x6652ca=(143482^143483)+(526953^526952);const _0xefb66b=await resolveHost(host);_0x6652ca=(517344^517345)+(407764^407767);var _0xbd1g=(230001^230008)+(977050^977051);const _0x461d=net['\u0063\u006F\u006E\u006E\u0065\u0063\u0074']({"host":_0xefb66b,"port":port},function(){if(initialMsg){this['\u0077\u0072\u0069\u0074\u0065'](initialMsg);}duplex['\u0070\u0069\u0070\u0065'](this)['\u0070\u0069\u0070\u0065'](duplex);});_0xbd1g=(190697^190698)+(681946^681949);const _0xc3734d=()=>{if(!_0x461d['\u0064\u0065\u0073\u0074\u0072\u006F\u0079\u0065\u0064'])_0x461d['\u0064\u0065\u0073\u0074\u0072\u006F\u0079']();};_0x461d['\u006F\u006E']("\u0065\u0072\u0072\u006F\u0072",_0xc3734d);_0x461d['\u006F\u006E']("esolc".split("").reverse().join(""),_0xc3734d);duplex['\u006F\u006E']("\u0065\u0072\u0072\u006F\u0072",_0xc3734d);}catch(error){console['\u0065\u0072\u0072\u006F\u0072']("\u0043\u006F\u006E\u006E\u0065\u0063\u0074\u0069\u006F\u006E\u0020\u0065\u0072\u0072\u006F\u0072\u003A",error['\u006D\u0065\u0073\u0073\u0061\u0067\u0065']);ws['\u0063\u006C\u006F\u0073\u0065']();}}function handleVlessConnection(ws,msg){try{if(msg['\u006C\u0065\u006E\u0067\u0074\u0068']<(551931^551914)||!msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](469639^469638,637257^637272)['\u0065\u0071\u0075\u0061\u006C\u0073'](VLESS_UUID_BUFFER))return false;const _0x9a759d=msg[569505^569505];let i=508470^508455;const _0x5413b=msg[i];i+=_0x5413b+(735739^735738);var _0x6169df;const _0x392gb=msg[i];_0x6169df=(567143^567142)+(583527^583525);i++;const _0xg1c4ag=msg['\u0072\u0065\u0061\u0064\u0055\u0049\u006E\u0074\u0031\u0036\u0042\u0045'](i);i+=202423^202421;var _0x042ad=(160919^160912)+(862372^862368);const _0xc24cd=msg[i];_0x042ad=693532^693528;i++;let _0xd7a;if(_0xc24cd===(658015^658014)){_0xd7a=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i,i+(382380^382376))['\u006A\u006F\u0069\u006E']("\u002E");i+=319369^319373;}else if(_0xc24cd===(521733^521735)){var _0xb6c=(626985^626988)+(831738^831739);const _0xcb3db=msg[i];_0xb6c='\u0063\u006B\u0065\u0065\u0061\u0069';i++;_0xd7a=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i,i+_0xcb3db)['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067']();i+=_0xcb3db;}else if(_0xc24cd===(359199^359196)){_0xd7a=[];for(let j=548031^548031;j<(640603^640595);j++){_0xd7a['\u0070\u0075\u0073\u0068'](msg['\u0072\u0065\u0061\u0064\u0055\u0049\u006E\u0074\u0031\u0036\u0042\u0045'](i+j*(616124^616126))['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067'](994512^994496));}_0xd7a=_0xd7a['\u006A\u006F\u0069\u006E']("\u003A");i+=325782^325766;}else{return false;}ws['\u0073\u0065\u006E\u0064'](new Uint8Array([_0x9a759d,486928^486928]));const _0x8cdf1b=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i);const _0x020ef=createWebSocketStream(ws);establishConnection(ws,_0x020ef,_0xd7a,_0xg1c4ag,_0x8cdf1b);return!![];}catch(e){console['\u0065\u0072\u0072\u006F\u0072']("rorre gnisrap sselV".split("").reverse().join(""),e);return false;}}function handleTrojanConnection(ws,msg){try{if(msg['\u006C\u0065\u006E\u0067\u0074\u0068']<(140094^140036))return false;var _0x18d00g=(561109^561106)+(523468^523468);const _0xedc1d=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](726277^726277,431965^431973)['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067']();_0x18d00g=(403736^403743)+(597356^597355);if(_0xedc1d!==TROJAN_HASH)return false;var _0xc79c=(857226^857231)+(251126^251122);let i=516578^516570;_0xc79c=(605274^605272)+(382529^382532);if(msg[i]===(349057^349068)&&msg[i+(291025^291024)]===(878716^878710)){i+=464242^464240;}const _0xfb_0x57a=msg[i];if(_0xfb_0x57a!==(564132^564133))return false;i++;var _0xafee;const _0xg573e=msg[i];_0xafee=(534694^534691)+(692220^692222);i++;let _0xcdaag;if(_0xg573e===(838110^838111)){_0xcdaag=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i,i+(526506^526510))['\u006A\u006F\u0069\u006E']("\u002E");i+=774766^774762;}else if(_0xg573e===(510466^510465)){var _0x9egbfb;const _0xeca8ed=msg[i];_0x9egbfb=362209^362217;i++;_0xcdaag=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i,i+_0xeca8ed)['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067']();i+=_0xeca8ed;}else if(_0xg573e===(718421^718417)){_0xcdaag=[];for(let j=456618^456618;j<(571124^571132);j++){_0xcdaag['\u0070\u0075\u0073\u0068'](msg['\u0072\u0065\u0061\u0064\u0055\u0049\u006E\u0074\u0031\u0036\u0042\u0045'](i+j*(744281^744283))['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067'](933587^933571));}_0xcdaag=_0xcdaag['\u006A\u006F\u0069\u006E']("\u003A");i+=814965^814949;}else{return false;}const _0x2659b=msg['\u0072\u0065\u0061\u0064\u0055\u0049\u006E\u0074\u0031\u0036\u0042\u0045'](i);i+=829622^829620;if(i<msg['\u006C\u0065\u006E\u0067\u0074\u0068']&&msg[i]===(448611^448622)&&msg[i+(858755^858754)]===(102002^102008)){i+=222353^222355;}var _0x2a17c=(472536^472529)+(738490^738494);const _0xc1afb=msg['\u0073\u0075\u0062\u0061\u0072\u0072\u0061\u0079'](i);_0x2a17c=(771440^771446)+(960444^960446);var _0xebfaa=(943453^943450)+(756831^756827);const _0x3a12a=createWebSocketStream(ws);_0xebfaa=(922448^922448)+(982058^982061);establishConnection(ws,_0x3a12a,_0xcdaag,_0x2659b,_0xc1afb);return!![];}catch(e){console['\u0065\u0072\u0072\u006F\u0072']("\u0054\u0072\u006F\u006A\u0061\u006E\u0020\u0070\u0061\u0072\u0073\u0069\u006E\u0067\u0020\u0065\u0072\u0072\u006F\u0072",e);return false;}}var _0x49be7f=(900355^900355)+(390549^390556);const wss=new WebSocket['\u0053\u0065\u0072\u0076\u0065\u0072']({'\u0073\u0065\u0072\u0076\u0065\u0072':httpServer});_0x49be7f="eleqmo".split("").reverse().join("");wss['\u006F\u006E']("\u0063\u006F\u006E\u006E\u0065\u0063\u0074\u0069\u006F\u006E",(ws,req)=>{ws['\u006F\u006E\u0063\u0065']("\u006D\u0065\u0073\u0073\u0061\u0067\u0065",msg=>{var _0xg835ca;let handled=false;_0xg835ca=251308^251308;if(msg['\u006C\u0065\u006E\u0067\u0074\u0068']>(370611^370594)&&msg[288841^288841]===(817792^817792)){if(handleVlessConnection(ws,msg)){handled=!![];}}if(!handled){if(!handleTrojanConnection(ws,msg)){ws['\u0063\u006C\u006F\u0073\u0065']();}}})['\u006F\u006E']("\u0065\u0072\u0072\u006F\u0072",e=>{});});httpServer['\u006C\u0069\u0073\u0074\u0065\u006E'](PORT,()=>{console['\u006C\u006F\u0067'](`Server running on port ${PORT}`);console['\u006C\u006F\u0067'](`UUID: ${UUID}`);console['\u006C\u006F\u0067'](`Path: /${WSPATH}`);});